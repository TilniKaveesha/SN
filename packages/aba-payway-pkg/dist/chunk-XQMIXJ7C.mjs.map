{"version":3,"sources":["../src/utils/security.ts"],"sourcesContent":["// packages/aba-payway-pkg/src/utils/security.ts\n\nimport * as crypto from 'crypto';\n\n/**\n * Generates the Payway signature hash (HMAC-SHA512) based on concatenated fields.\n * @param hashInputString The concatenated string of (MerchantID + TranID + Amount + Items + ShippingCost).\n * @param apiKey The API Key used as the HMAC secret.\n * @returns The Base64-encoded signature hash string.\n */\nexport function generatePaywayHash(hashInputString: string, apiKey: string): string {\n    \n    // The input string is already the canonical string (b4hash)\n    \n    // 1. Create the HMAC hash\n    const hmac = crypto.createHmac('sha512', apiKey);\n    \n    // 2. Update with the stringified payload\n    hmac.update(hashInputString);\n    \n    // 3. Get the result as a raw binary buffer \n    const rawHash = hmac.digest();\n\n    // 4. Base64 encode the binary result\n    const finalHash = rawHash.toString('base64');\n\n    return finalHash;\n}"],"mappings":";AAEA,YAAY,YAAY;AAQjB,SAAS,mBAAmB,iBAAyB,QAAwB;AAKhF,QAAM,OAAc,kBAAW,UAAU,MAAM;AAG/C,OAAK,OAAO,eAAe;AAG3B,QAAM,UAAU,KAAK,OAAO;AAG5B,QAAM,YAAY,QAAQ,SAAS,QAAQ;AAE3C,SAAO;AACX;","names":[]}